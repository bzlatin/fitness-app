# EAS Build Commands - Quick Reference

## For iOS Widgets Implementation

### Local Build (Recommended - Saves Cloud Minutes)

```bash
# Navigate to mobile directory
cd /Users/ben/coding_projects/fitness-app/mobile

# Build for iOS development (local)
eas build --platform ios --profile development --local
```

**Pros:**
- ✅ Saves EAS cloud build minutes
- ✅ Faster feedback loop (~10-15 min)
- ✅ No upload/download time
- ✅ Full control over build artifacts

**Cons:**
- ⚠️ Requires Xcode installed locally
- ⚠️ Mac only
- ⚠️ Larger local disk usage (~5-10 GB)

**Requirements:**
- macOS with Xcode 15+
- Apple Developer account
- At least 10 GB free disk space

---

### Cloud Build (Alternative)

```bash
# Navigate to mobile directory
cd /Users/ben/coding_projects/fitness-app/mobile

# Build for iOS development (cloud)
eas build --platform ios --profile development
```

**Pros:**
- ✅ Works from any OS (macOS, Linux, Windows)
- ✅ No local Xcode required
- ✅ Consistent build environment

**Cons:**
- ⚠️ Uses EAS cloud build minutes
- ⚠️ Slower (~20-30 min including queue time)
- ⚠️ Requires upload/download of build artifacts

---

## Build Profiles

Your `eas.json` has these profiles:

### Development
```bash
eas build --platform ios --profile development --local
```
- **Purpose**: Internal testing, development builds
- **Distribution**: Internal only
- **Development Client**: Enabled
- **Use case**: Testing widgets, new features

### Preview
```bash
eas build --platform ios --profile preview --local
```
- **Purpose**: Beta testing, TestFlight
- **Distribution**: Internal
- **Use case**: Pre-release testing

### Production
```bash
eas build --platform ios --profile production
```
- **Purpose**: App Store release
- **Distribution**: App Store
- **Auto-increment**: Enabled
- **Use case**: Production releases
- **Note**: Don't use `--local` for production (use cloud for consistency)

---

## After Build Completes

### For Local Builds

1. **Build artifact location**: `./build-XXXXX.ipa` (in mobile directory)
2. **Install on device**:
   ```bash
   # Via Xcode
   # Drag .ipa to Devices window in Xcode

   # Via command line (simulator)
   xcrun simctl install booted ./build-XXXXX.ipa
   ```

3. **Open Xcode project**:
   ```bash
   cd ios
   open pushpull.xcworkspace
   ```

4. **Complete manual widget setup** (see `/mobile/ios/Widgets/README.md`)

### For Cloud Builds

1. **Download build**:
   - Check EAS build status: `eas build:list`
   - Download from EAS dashboard or use provided link

2. **Install on device**:
   - Same as local builds

---

## Troubleshooting Build Issues

### Build fails with "No provisioning profile"

**Solution:**
```bash
# Log in to EAS
eas login

# Configure credentials
eas credentials
```

### Build fails with "Expo config plugin error"

**Solution:**
1. Check `/mobile/plugins/withWidgets.js` syntax
2. Verify plugin is listed in `app.config.ts`
3. Run: `expo prebuild --clean` to regenerate native projects

### Build succeeds but widgets don't show up

**Solution:**
- This is expected! You need manual Xcode setup
- See `/mobile/ios/Widgets/README.md` for widget target setup
- Widget extension targets can't be auto-generated by Expo

### "Module not found" errors in widget Swift files

**Solution:**
1. Open Xcode: `cd ios && open pushpull.xcworkspace`
2. Clean build folder: **Product → Clean Build Folder**
3. Rebuild widget target

---

## Build Time Estimates

| Profile | Local | Cloud |
|---------|-------|-------|
| Development | 10-15 min | 20-30 min |
| Preview | 12-18 min | 25-35 min |
| Production | 15-20 min | 30-40 min |

*Note: Times vary based on machine specs and network speed*

---

## Disk Space Requirements

### Local Builds
- **Xcode**: ~15 GB
- **Build cache**: ~5 GB
- **Per build**: ~2-3 GB
- **Total**: ~25 GB minimum

### Cloud Builds
- **Minimal**: Just the .ipa file (~100-200 MB)

---

## Cost Comparison

### Local Builds (Free)
- ✅ Unlimited builds
- ✅ No EAS minutes used
- ⚠️ Requires Mac + Xcode

### Cloud Builds
- Free tier: 30 builds/month
- Paid: $29/month for unlimited

**Recommendation for widgets**: Use local builds during development, cloud builds for production releases.

---

## Common Commands

```bash
# Check build status
eas build:list

# View build logs
eas build:view [BUILD_ID]

# Cancel a build
eas build:cancel [BUILD_ID]

# Configure credentials
eas credentials

# Check EAS account
eas whoami

# Update EAS CLI
npm install -g eas-cli@latest
```

---

## Next Steps After Build

1. ✅ Build completes
2. ⏳ Open Xcode workspace
3. ⏳ Add widget extension targets
4. ⏳ Add Swift files to widget target
5. ⏳ Configure App Groups
6. ⏳ Build and test widgets

See full instructions: `/mobile/ios/Widgets/README.md`
